{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ashutosh/Desktop/avalanche-faucet/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/ashutosh/Desktop/avalanche-faucet/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";export var addNetwork=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(config){var _window,_window$ethereum,_config$CHAINID;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(config){_context.next=2;break;}return _context.abrupt(\"return\");case 2:if(window.ethereum==undefined){window.open('https://metamask.io/download','_blank');}_context.next=5;return(_window=window)===null||_window===void 0?void 0:(_window$ethereum=_window.ethereum)===null||_window$ethereum===void 0?void 0:_window$ethereum.request({method:'wallet_addEthereumChain',params:[{chainId:\"0x\".concat((_config$CHAINID=config.CHAINID)===null||_config$CHAINID===void 0?void 0:_config$CHAINID.toString(16)),chainName:config.NAME,nativeCurrency:{name:config.NAME,symbol:config.TOKEN,decimals:18},rpcUrls:[config.RPC],blockExplorerUrls:config.EXPLORER?[config.EXPLORER]:null}]}).catch(function(error){console.log(error);});case 5:case\"end\":return _context.stop();}}},_callee);}));return function addNetwork(_x){return _ref.apply(this,arguments);};}();export var addAsset=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(config){var _window2,_window2$ethereum;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(config){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:if(window.ethereum==undefined){window.open('https://metamask.io/download','_blank');}_context2.next=5;return(_window2=window)===null||_window2===void 0?void 0:(_window2$ethereum=_window2.ethereum)===null||_window2$ethereum===void 0?void 0:_window2$ethereum.request({method:'wallet_watchAsset',params:{type:'ERC20',options:{address:config.CONTRACTADDRESS,symbol:config.TOKEN,decimals:config.DECIMALS||18}}}).catch(function(error){console.log(error);});case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function addAsset(_x2){return _ref2.apply(this,arguments);};}();export var connectAccount=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(updateAddress){var showPopup,_args5=arguments;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:showPopup=_args5.length>1&&_args5[1]!==undefined?_args5[1]:true;if(!(window.ethereum==undefined)){_context5.next=4;break;}showPopup&&window.open('https://metamask.io/download','_blank');return _context5.abrupt(\"return\");case 4:try{window.ethereum.request({method:'eth_accounts'}).then(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(accounts){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return handleConnection(accounts,showPopup);case 2:accounts=_context3.sent;updateAddress(accounts[0]);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x4){return _ref4.apply(this,arguments);};}()).catch(console.error);window.ethereum.on('accountsChanged',/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){var accounts;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return window.ethereum.enable();case 2:accounts=_context4.sent;updateAddress(accounts[0]);case 4:case\"end\":return _context4.stop();}}},_callee4);})));}catch(_unused){alert(\"Request denied!\");}case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function connectAccount(_x3){return _ref3.apply(this,arguments);};}();function handleConnection(_x5,_x6){return _handleConnection.apply(this,arguments);}function _handleConnection(){_handleConnection=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(accounts,showPopup){var _accounts;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(!(accounts.length===0)){_context6.next=14;break;}if(!showPopup){_context6.next=12;break;}_context6.prev=2;_context6.next=5;return window.ethereum.request({method:'eth_requestAccounts'});case 5:_accounts=_context6.sent;return _context6.abrupt(\"return\",_accounts);case 9:_context6.prev=9;_context6.t0=_context6[\"catch\"](2);console.log(\"Request denied!\");case 12:_context6.next=15;break;case 14:return _context6.abrupt(\"return\",accounts);case 15:case\"end\":return _context6.stop();}}},_callee6,null,[[2,9]]);}));return _handleConnection.apply(this,arguments);}","map":{"version":3,"names":["addNetwork","config","window","ethereum","undefined","open","request","method","params","chainId","CHAINID","toString","chainName","NAME","nativeCurrency","name","symbol","TOKEN","decimals","rpcUrls","RPC","blockExplorerUrls","EXPLORER","catch","error","console","log","addAsset","type","options","address","CONTRACTADDRESS","DECIMALS","connectAccount","updateAddress","showPopup","then","accounts","handleConnection","on","enable","alert","length"],"sources":["/Users/ashutosh/Desktop/avalanche-faucet/client/src/components/Metamask.ts"],"sourcesContent":["declare global {\n    interface Window {\n        ethereum: any\n    }\n}\n\nexport const addNetwork = async (config: any): Promise<void> => {\n    if(!config) {\n        return\n    }\n    if(window.ethereum == undefined) {\n        window.open('https://metamask.io/download', '_blank')\n    }\n\n    await window?.ethereum?.request({\n        method: 'wallet_addEthereumChain',\n        params: [{\n            chainId: `0x${config.CHAINID?.toString(16)}`,\n            chainName: config.NAME,\n            nativeCurrency: {\n                name: config.NAME,\n                symbol: config.TOKEN,\n                decimals: 18\n            },\n            rpcUrls: [config.RPC],\n            blockExplorerUrls: config.EXPLORER ? [config.EXPLORER] : null\n        }]\n    }).catch((error: any): void => {\n        console.log(error)\n    })      \n}\n\nexport const addAsset = async (config: any): Promise<void> => {\n    if(!config) {\n        return\n    }\n    if(window.ethereum == undefined) {\n        window.open('https://metamask.io/download', '_blank')\n    }\n\n    await window?.ethereum?.request({\n        method: 'wallet_watchAsset',\n        params: {\n            type: 'ERC20',\n            options: {\n                address: config.CONTRACTADDRESS,\n                symbol: config.TOKEN,\n                decimals: config.DECIMALS || 18\n            }\n        }\n    }).catch((error: any): void => {\n        console.log(error)\n    })  \n}\n\nexport const connectAccount = async (updateAddress: any, showPopup = true) => {\n    if(window.ethereum == undefined) {\n        showPopup && window.open('https://metamask.io/download', '_blank')\n        return\n    }\n\n    try {\n        window.ethereum.request({ method: 'eth_accounts' }).then(\n            async (accounts: any) => {\n                accounts = await handleConnection(accounts, showPopup)\n                updateAddress(accounts[0])\n            }\n        ).catch(\n            console.error\n        )\n\n        window.ethereum.on('accountsChanged', async function () {\n            const accounts = await window.ethereum.enable()\n            updateAddress(accounts[0]);\n        })\n    } catch {\n        alert(\"Request denied!\")\n    }\n}\n\nasync function handleConnection(accounts: any, showPopup: boolean) {\n    if(accounts.length === 0) {\n        if(showPopup) {\n            try {\n                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' })\n                return accounts\n            } catch(err) {\n                console.log(\"Request denied!\")\n            }\n        }\n    } else {\n        return accounts\n    }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}