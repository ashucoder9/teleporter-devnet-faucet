{"ast":null,"code":"export const addNetwork = async config => {\n  var _window, _window$ethereum, _config$CHAINID;\n\n  if (!config) {\n    return;\n  }\n\n  if (window.ethereum == undefined) {\n    window.open('https://metamask.io/download', '_blank');\n  }\n\n  await ((_window = window) === null || _window === void 0 ? void 0 : (_window$ethereum = _window.ethereum) === null || _window$ethereum === void 0 ? void 0 : _window$ethereum.request({\n    method: 'wallet_addEthereumChain',\n    params: [{\n      chainId: `0x${(_config$CHAINID = config.CHAINID) === null || _config$CHAINID === void 0 ? void 0 : _config$CHAINID.toString(16)}`,\n      chainName: config.NAME,\n      nativeCurrency: {\n        name: config.NAME,\n        symbol: config.TOKEN,\n        decimals: 18\n      },\n      rpcUrls: [config.RPC],\n      blockExplorerUrls: config.EXPLORER ? [config.EXPLORER] : null\n    }]\n  }).catch(error => {\n    console.log(error);\n  }));\n};\nexport const addAsset = async config => {\n  var _window2, _window2$ethereum;\n\n  if (!config) {\n    return;\n  }\n\n  if (window.ethereum == undefined) {\n    window.open('https://metamask.io/download', '_blank');\n  }\n\n  await ((_window2 = window) === null || _window2 === void 0 ? void 0 : (_window2$ethereum = _window2.ethereum) === null || _window2$ethereum === void 0 ? void 0 : _window2$ethereum.request({\n    method: 'wallet_watchAsset',\n    params: {\n      type: 'ERC20',\n      options: {\n        address: config.CONTRACTADDRESS,\n        symbol: config.TOKEN,\n        decimals: config.DECIMALS || 18\n      }\n    }\n  }).catch(error => {\n    console.log(error);\n  }));\n};\nexport const connectAccount = async function (updateAddress) {\n  let showPopup = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n  if (window.ethereum == undefined) {\n    showPopup && window.open('https://metamask.io/download', '_blank');\n    return;\n  }\n\n  try {\n    window.ethereum.request({\n      method: 'eth_accounts'\n    }).then(async accounts => {\n      accounts = await handleConnection(accounts, showPopup);\n      updateAddress(accounts[0]);\n    }).catch(console.error);\n    window.ethereum.on('accountsChanged', async function () {\n      const accounts = await window.ethereum.enable();\n      updateAddress(accounts[0]);\n    });\n  } catch {\n    alert(\"Request denied!\");\n  }\n};\n\nasync function handleConnection(accounts, showPopup) {\n  if (accounts.length === 0) {\n    if (showPopup) {\n      try {\n        const accounts = await window.ethereum.request({\n          method: 'eth_requestAccounts'\n        });\n        return accounts;\n      } catch (err) {\n        console.log(\"Request denied!\");\n      }\n    }\n  } else {\n    return accounts;\n  }\n}","map":{"version":3,"names":["addNetwork","config","window","ethereum","undefined","open","request","method","params","chainId","CHAINID","toString","chainName","NAME","nativeCurrency","name","symbol","TOKEN","decimals","rpcUrls","RPC","blockExplorerUrls","EXPLORER","catch","error","console","log","addAsset","type","options","address","CONTRACTADDRESS","DECIMALS","connectAccount","updateAddress","showPopup","then","accounts","handleConnection","on","enable","alert","length","err"],"sources":["/Users/ashutosh/Desktop/avalanche-faucet/client/src/components/Metamask.ts"],"sourcesContent":["declare global {\n    interface Window {\n        ethereum: any\n    }\n}\n\nexport const addNetwork = async (config: any): Promise<void> => {\n    if(!config) {\n        return\n    }\n    if(window.ethereum == undefined) {\n        window.open('https://metamask.io/download', '_blank')\n    }\n\n    await window?.ethereum?.request({\n        method: 'wallet_addEthereumChain',\n        params: [{\n            chainId: `0x${config.CHAINID?.toString(16)}`,\n            chainName: config.NAME,\n            nativeCurrency: {\n                name: config.NAME,\n                symbol: config.TOKEN,\n                decimals: 18\n            },\n            rpcUrls: [config.RPC],\n            blockExplorerUrls: config.EXPLORER ? [config.EXPLORER] : null\n        }]\n    }).catch((error: any): void => {\n        console.log(error)\n    })      \n}\n\nexport const addAsset = async (config: any): Promise<void> => {\n    if(!config) {\n        return\n    }\n    if(window.ethereum == undefined) {\n        window.open('https://metamask.io/download', '_blank')\n    }\n\n    await window?.ethereum?.request({\n        method: 'wallet_watchAsset',\n        params: {\n            type: 'ERC20',\n            options: {\n                address: config.CONTRACTADDRESS,\n                symbol: config.TOKEN,\n                decimals: config.DECIMALS || 18\n            }\n        }\n    }).catch((error: any): void => {\n        console.log(error)\n    })  \n}\n\nexport const connectAccount = async (updateAddress: any, showPopup = true) => {\n    if(window.ethereum == undefined) {\n        showPopup && window.open('https://metamask.io/download', '_blank')\n        return\n    }\n\n    try {\n        window.ethereum.request({ method: 'eth_accounts' }).then(\n            async (accounts: any) => {\n                accounts = await handleConnection(accounts, showPopup)\n                updateAddress(accounts[0])\n            }\n        ).catch(\n            console.error\n        )\n\n        window.ethereum.on('accountsChanged', async function () {\n            const accounts = await window.ethereum.enable()\n            updateAddress(accounts[0]);\n        })\n    } catch {\n        alert(\"Request denied!\")\n    }\n}\n\nasync function handleConnection(accounts: any, showPopup: boolean) {\n    if(accounts.length === 0) {\n        if(showPopup) {\n            try {\n                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' })\n                return accounts\n            } catch(err) {\n                console.log(\"Request denied!\")\n            }\n        }\n    } else {\n        return accounts\n    }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}